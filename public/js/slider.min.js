/*! CSS Slider jQuery plugin | (c) 2013 digital-telepathy | http://www.dtelepathy.com/ */
(function($,window,undefined,I){var CSSSlider=function(el,params){this._dropdownNavVisible=false;this._eventTrigger={};this._interacting=false;this._interactingOffset={top:-1,left:-1};this.elements={};this.current=0;this.previous=-1;this.namespace="slider";this.sliderWidth=-1;this.sliderHeight=-1;this.navigationGutter=0;this.autoPlay=false;this.preventDefaultSwipeX=false;this.preventDefaultSwipeY=true;this.options={easing:"ease-in-out",loop:true,method:'css',navigation:'>.slider-navigation',navigationWidth:"24%",next:'>.next',orientation:'horizontal',prev:'>.prev',slides:'>.slide',speed:500,start:0,touch:false,autoPlay:false,autoPlayDelay:5000,dropdownNav:true,touchThreshold:4};this.initialize(el,params)};CSSSlider.prototype._addNavigationElements=function(container){var self=this;this.elements.slides.each(function(ind){var $slide=self.elements.slides.eq(ind);var label=$slide.data('label')||"Slide "+(ind+1);container.append('<a href="#" data-slide="'+ind+'"><span>'+label+'</span></a>')})};CSSSlider.prototype._adjustDimensions=function(){var self=this;this.sliderWidth=this.elements.slider.width();this.sliderHeight=this.elements.slider.height();if(this.elements.navigation.length&&this.options.orientation=="vertical"){if(Modernizr.mq('only screen and (max-width: 767px)')){this.showDropdownNav()}else{this.hideDropdownNav()}}this._getNavigationDimensions();this.elements.slides.each(function(ind){var css={left:(ind-self.current)*(self.sliderWidth+self.navigationGutter),width:self.sliderWidth-self.navigationGutter,height:self.sliderHeight};if(self.options.orientation=="vertical"){css.left=self.navigationGutter;css.top=(ind-self.current)*self.sliderHeight}self.elements.slides.eq(ind).css(css,$.extend(I.prefixCSS({transition:'left 0ms, top 0ms'})))});if(this.elements.navigation.length&&this.options.orientation=="vertical"){this.elements.navigation.width(this.navigationGutter);this.elements.navigation.height(this.sliderHeight);this.elements.navigationLinks.css({height:Math.round(this.sliderHeight/this.elements.navigationLinks.length)})}};CSSSlider.prototype._autoPlay=function(){var self=this;setTimeout(function(){if(self.autoPlay){self.next()}self._autoPlay()},this.options.autoPlayDelay)}CSSSlider.prototype._bindEvents=function(){var self=this;this.elements.prev.on('click',function(event){event.preventDefault();self.autoPlay=false;self.prev()});this.elements.next.on('click',function(event){event.preventDefault();self.autoPlay=false;self.next()});this.elements.navigation.on('click','a',function(event){event.preventDefault();var $this=$.data(this,'$this')||$.data(this,'$this',$(this));self.autoPlay=false;self.goTo($this.data('slide'))});this.elements.body.on('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd',function(event){if(self.elements.slides.filter(event.target).length){self._eventComplete()}});this.elements.slider.on('mousedown',function(event){if(event.button<=1)self._touchStart(event)}).on('mousemove',function(event){if(event.button<=1)self._touchMove(event)}).on('mouseup',function(event){if(event.button<=1)self._touchEnd(event)});if(window.addEventListener){this.elements.slider[0].addEventListener('touchstart',self._touchStart,false)}$(window).resize(function(){self._adjustDimensions()}).resize($.throttle(250,function(){self._setTransition()}));this.elements.slider.on(this.namespace+':before',function(event,slider,index){var label=self.elements.slides.eq(index).data('label')||"Slide "+(index+1);if(typeof(self.elements.dropdownNav)!='undefined'){self.elements.dropdownNavSelected.text(label);self.elements.dropdownNavLinks.removeClass('active').eq(index).addClass('active')}if(self.elements.navigation.length){self.elements.navigationLinks.removeClass('active').eq(index).addClass('active')}})};CSSSlider.prototype._build=function(){var self=this;this.sliderWidth=this.elements.slider.width();this.sliderHeight=this.elements.slider.height();if(this.elements.navigation.length){this._buildNavigation()}if(this.options.method=="css"){this._setTransition()}this.elements.slides.each(function(ind){var css={position:"absolute",left:(ind-self.current)*self.sliderWidth};if(self.options.orientation=="vertical"){self.preventDefaultSwipeX=true;self.preventDefaultSwipeY=false;css=$.extend(css,{left:this.navigationGutter,top:(ind-self.current)*self.sliderHeight,width:self.sliderWidth,height:self.sliderHeight})}self.elements.slides.eq(ind).css(css)})};CSSSlider.prototype._buildDropdownNav=function(){var self=this;this.elements.dropdownNav=$('<div class="'+this.namespace+'-dropdown-nav" />').insertBefore(this.elements.slider);this.elements.dropdownNavSelected=$('<div class="'+this.namespace+'-dropdown-nav-selected" />').appendTo(this.elements.dropdownNav);this.elements.dropdownNavOptions=$('<div class="'+this.namespace+'-dropdown-nav-options" />').appendTo(this.elements.dropdownNav);this.elements.dropdownNavList=$('<div class="'+this.namespace+'-dropdown-nav-list" />').appendTo(this.elements.dropdownNavOptions);this._addNavigationElements(this.elements.dropdownNavList);this.elements.dropdownNavLinks=this.elements.dropdownNavOptions.find('a');this.elements.dropdownNavSelected.text(this.elements.dropdownNavLinks.eq(this.current).addClass('active').text());this.elements.dropdownNavSelected.on('click',function(event){event.preventDefault();self.elements.dropdownNavOptions.show();self.elements.body.on('click.'+self.namespace,function(event){if($(event.target).closest('.'+self.namespace+'-dropdown-nav-list, .'+self.namespace+'-dropdown-nav-selected').length<1){self.elements.dropdownNavOptions.hide();self.elements.body.off('click.'+self.namespace)}})});this.elements.dropdownNavOptions.on('click','a',function(event){event.preventDefault();var $this=$.data(this,'$this')||$.data(this,'$this',$(this));self.elements.dropdownNavOptions.hide();self.elements.body.off('click.'+self.namespace);self.autoPlay=false;self.goTo($this.data('slide'))})};CSSSlider.prototype._buildNavigation=function(){var self=this;this._addNavigationElements(this.elements.navigation);this.elements.navigationLinks=this.elements.navigation.find('a');this.elements.navigationLinks.eq(this.current).addClass('active');if(this.options.orientation=='vertical'){var navHeight=(this.sliderHeight/this.elements.slides.length);this._getNavigationDimensions();this.elements.navigation.css({position:"absolute",top:0,left:0,width:this.navigationGutter,height:this.sliderHeight});this.elements.navigationLinks.css({position:"relative",height:navHeight+"px"}).eq(this.current).addClass('active')}};CSSSlider.prototype._eventComplete=function(){if(this._triggerEvent('complete')){this.animating=false;this.elements.slider.triggerHandler(this.namespace+':complete',[this]);this._eventTrigger.complete=0}};CSSSlider.prototype._getElements=function(){this.elements.body=$(document.body);this.elements.slides=this.elements.slider.find(this.options.slides);this.elements.prev=this.elements.slider.find(this.options.prev);if(!this.elements.prev.length)this.elements.prev=$(this.options.prev);this.elements.next=this.elements.slider.find(this.options.next);if(!this.elements.next.length)this.elements.next=$(this.options.next);this.elements.navigation=this.elements.slider.find(this.options.navigation);if(!this.elements.navigation.length)this.elements.navigation=$(this.options.navigation)};CSSSlider.prototype._getNavigationDimensions=function(){if(this.elements.navigation.length==0)return false;if(this.options.orientation!='vertical')return false;this.navigationGutter=this.options.navigationWidth;if(this.options.navigationWidth.indexOf('%')!=-1){this.navigationGutter=parseFloat(this.options.navigationWidth.replace("%",""))/100*this.sliderWidth}if(this._dropdownNavVisible)this.navigationGutter=0};CSSSlider.prototype._setTransition=function(slide){var self=this;var css=I.prefixCSS({transition:'left '+this.options.speed+'ms '+this.options.easing+', top '+this.options.speed+'ms '+this.options.easing});if(slide!=undefined){slide.css(css)}else{this.elements.slides.css(css)}};CSSSlider.prototype._touchEnd=function(event){var slider=($(this).data("CSSSlider")==undefined)?this:$(this).data("CSSSlider");if(slider.options.touch===false)return false;if(window.addEventListener){slider.elements.slider[0].removeEventListener('touchmove',slider._touchMove,false)}slider._interacting=false;slider._interactingOffset.end=slider._touchOffset(event);slider.elements.slides.css(I.prefixCSS({'transition-duration':slider.options.speed+'ms'}));var breach=false;var direction='next';if(slider.options.orientation=="horizontal"){breach=Math.abs(slider._interactingOffset.left/slider.sliderWidth)>=0.5;if(slider._interactingOffset.left>0)direction='prev'}else{breach=Math.abs(slider._interactingOffset.top/slider.sliderHeight)>=0.5;if(slider._interactingOffset.top>0)direction='prev'}if(slider._interactionMoving&&breach){slider.autoPlay=false;slider[direction]()}else{slider.elements.slides.each(function(ind){var css={};if(slider.options.orientation=="horizontal"){css.left=(ind-slider.current)*slider.sliderWidth}else{css.top=(ind-slider.current)*slider.sliderHeight}slider.elements.slides.eq(ind).css(css)})}if(window.addEventListener){slider.elements.slider[0].removeEventListener('touchend',slider._touchEnd,false)}};CSSSlider.prototype._touchMove=function(event){var slider=($(this).data("CSSSlider")==undefined)?this:$(this).data("CSSSlider");if(slider.options.touch===false)return false;if(slider._interacting){slider._interactionMoving=true;var offset=slider._touchOffset(event);slider._interactingOffset.left=offset.left-slider._interactingOffset.start.left;slider._interactingOffset.top=offset.top-slider._interactingOffset.start.top;if((Math.abs(slider._interactingOffset.left)>Math.abs(slider._interactingOffset.top))){if(slider.options.orientation=="horizontal"){event.preventDefault()}if(slider.preventDefaultSwipeX){return false}}else if((Math.abs(slider._interactingOffset.top)>Math.abs(slider._interactingOffset.left))){if(slider.options.orientation=="vertical"){event.preventDefault()}return false}slider.elements.slides.each(function(ind){var css={};if(slider.options.orientation=="horizontal"){css.left=((ind-slider.current)*slider.sliderWidth)+slider._interactingOffset.left}else{css.top=((ind-slider.current)*slider.sliderHeight)+slider._interactingOffset.top}slider.elements.slides.eq(ind).css(css)})}};CSSSlider.prototype._touchOffset=function(event){var offset={top:-1,left:-1};if(event.touches){if(event.touches.length){if(event.touches[0].pageY)offset.top=event.touches[0].pageY;if(event.touches[0].pageX)offset.left=event.touches[0].pageX}}else{offset.top=event.screenY;offset.left=event.screenX}return offset};CSSSlider.prototype._touchStart=function(event){var slider=($(this).data("CSSSlider")==undefined)?this:$(this).data("CSSSlider");if(slider.options.touch===false)return false;slider._interacting=true;slider._interactionMoving=false;var offset=slider._touchOffset(event);slider.autoPlay=false;slider._interactingOffset={top:offset.top,left:offset.left,start:{top:offset.top,left:offset.left}};slider.elements.slides.css(I.prefixCSS({'transition-duration':'0ms'}));if(window.addEventListener){slider.elements.slider[0].addEventListener('touchmove',slider._touchMove,false);slider.elements.slider[0].addEventListener('touchend',slider._touchEnd,false)}};CSSSlider.prototype._triggerEvent=function(eventname){if(this._eventTrigger[eventname]==undefined)this._eventTrigger[eventname]=0;this._eventTrigger[eventname]++;if(this._eventTrigger[eventname]==this.elements.slides.length){this._eventTrigger[eventname]=0;return true}return false};CSSSlider.prototype.goTo=function(slide){var index=-1;switch(typeof(slide)){case'number':index=slide;break;case'string':case'object':index=this.elements.slides.index($(slide));break}if(index>-1){this.slide(index)}};CSSSlider.prototype.hideDropdownNav=function(){this._dropdownNavVisible=false;if(typeof(this.elements.dropdownNav)!='undefined')this.elements.dropdownNav.hide();this.elements.navigation.show()};CSSSlider.prototype.initialize=function(el){var self=this;this.options=$.extend(this.options,arguments[1][0]||{},$(el).data());this.autoPlay=this.options.autoPlay;if(!I.supports('cssanimations')){this.options.method="animate"}this.current=this.options.start;this.elements.slider=$(el);this._getElements();this._bindEvents();this._build();this._autoPlay();this._adjustDimensions();setTimeout(function(){self._setTransition()},100)};CSSSlider.prototype.next=function(){var slide=Math.min(this.elements.slides.length-1,this.current+1);if(this.options.loop!==false&&(this.current==this.elements.slides.length-1)){slide=0}this.goTo(slide)};CSSSlider.prototype.option=function(key,val){if(val!=undefined)this.options[key]=val;return this.options[key]};CSSSlider.prototype.prev=function(){var slide=Math.max(0,this.current-1);if(this.options.loop!==false&&this.current==0){slide=this.elements.slides.length-1}this.goTo(slide)};CSSSlider.prototype.run=function(){var arguments_array=[];for(var i=0;i<arguments.length;i++){arguments_array.push(arguments[i])}var action=arguments_array[0];var args=arguments_array.length>1?arguments_array.slice(1):[];if(typeof(this[action])=='function'){return this[action].apply(this,args)}else if(typeof(this[action])!='undefined'){if(args.length>0)this[action]=args[0];return this[action]}};CSSSlider.prototype.slide=function(index){var self=this;this.animating=true;this.previous=this.current;this.current=index;this.elements.slider.triggerHandler(this.namespace+":before",[this,index]);if(this.elements.navigation.length){this.elements.navigationLinks.removeClass('active').eq(this.current).addClass('active')}this.elements.slides.each(function(ind){var $slide=self.elements.slides.eq(ind);if(self.options.method=="animate"){$slide.stop()}var css={};if(self.options.orientation=="horizontal"){css.left=(ind-self.current)*self.sliderWidth}else{css.top=(ind-self.current)*self.sliderHeight}$slide[self.options.method](css,self.options.speed,function(){if(self.options.method!="css"){self._eventComplete.apply(self)}})})};CSSSlider.prototype.showDropdownNav=function(){if(!this.options.dropdownNav){return false}if(!this.elements.dropdownNav){this._buildDropdownNav()}this._dropdownNavVisible=true;this.elements.dropdownNav.show();this.elements.navigation.hide()};$.extend($.fn,{cssSlider:function(){var options=action=arguments;var _return=this;this.each(function(ind){var _CSSSlider=$.data(this,'CSSSlider');if(!_CSSSlider){_CSSSlider=new CSSSlider(this,options);$.data(this,'CSSSlider',_CSSSlider)}if(action.length>0){var _do=_CSSSlider.run.apply(_CSSSlider,action);if(typeof(_do)!='undefined'){_return=_do}}});return _return}})})(jQuery,window,null,Impress);